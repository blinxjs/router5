!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.reduxRouter5=t.reduxRouter5||{})}(this,function(t){"use strict";function e(t,e){return{type:y,payload:{route:t,previousRoute:e}}}function n(t,e){return{type:d,payload:{route:t,previousRoute:e}}}function r(t,e,n){return{type:f,payload:{route:t,previousRoute:e,transitionError:n}}}function o(t){function o(){return{onTransitionStart:function(n,r){t(e(n,r))},onTransitionSuccess:function(e,r){t(n(e,r))},onTransitionError:function(e,n,o){t(r(e,n,o))}}}return o.pluginName="REDUX_PLUGIN",o}function u(t){return t.split(".").reduce(function(t,e){return t.concat(t.length?t[t.length-1]+"."+e:e)},[])}function a(t){return void 0!==t&&null!==t}function i(t){return t&&t.meta&&t.meta.params}function c(t,e){return a(e.meta.params[t])?Object.keys(e.meta.params[t]).reduce(function(t,n){return t[n]=e.params[n],t},{}):{}}function s(t,e){var n=e?u(e.name):[],r=u(t.name),o=Math.min(n.length,r.length),a=void 0;e?i(e)||i(t)?a=function(){var u=void 0;for(u=0;u<o;u+=1){var a=function(){var o=n[u],a=r[u];if(o!==a)return{v:u};var i=c(o,t),s=c(a,e);return i.length!==s.length?{v:u}:0===i.length?"continue":Object.keys(i).some(function(t){return s[t]!==i[t]})?{v:u}:void 0}();switch(a){case"continue":continue;default:if("object"===(void 0===a?"undefined":N(a)))return a.v}}return u}():(console.warn("[router5-transition-path] Some states are missing metadata, reloading all segments"),a=0):a=0;var s=n.slice(a).reverse(),l=r.slice(a);return{intersection:e&&a>0?n[a-1]:"",toDeactivate:s,toActivate:l}}var l="@@router5/NAVIGATE",p="@@router5/CANCEL",f="@@router5/TRANSITION_ERROR",d="@@router5/TRANSITION_SUCCESS",y="@@router5/TRANSITION_START",v="@@router5/CLEAR_ERRORS",m="@@router5/CAN_DEACTIVATE",R="@@router5/CAN_ACTIVATE",T=Object.freeze({NAVIGATE_TO:l,CANCEL_TRANSITION:p,TRANSITION_ERROR:f,TRANSITION_SUCCESS:d,TRANSITION_START:y,CLEAR_ERRORS:v,CAN_DEACTIVATE:m,CAN_ACTIVATE:R}),A=Object.freeze({navigateTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:l,payload:{name:t,params:e,opts:n}}},cancelTransition:function(){return{type:p}},clearErrors:function(){return{type:v}},transitionStart:e,transitionSuccess:n,transitionError:r,canActivate:function(t,e){return{type:R,payload:{name:t,canActivate:e}}},canDeactivate:function(t,e){return{type:m,payload:{name:t,canDeactivate:e}}}}),S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},E=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b={route:null,previousRoute:null,transitionRoute:null,transitionError:null},N="function"==typeof Symbol&&"symbol"===S(Symbol.iterator)?function(t){return void 0===t?"undefined":S(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":S(t)};t.router5Middleware=function(t){return function(e){var n=e.dispatch;return t.setDependency("store",e),t.usePlugin(o(n)),function(e){return function(n){switch(n.type){case l:t.navigate(n.payload.name,n.payload.params,n.payload.opts);break;case p:t.cancel();break;case m:t.canDeactivate(n.payload.name,n.payload.canDeactivate);break;case R:t.canActivate(n.payload.name,n.payload.canDeactivate);break;default:return e(n)}}}}},t.router5Reducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,e=arguments[1];switch(e.type){case y:return E({},t,{transitionRoute:e.payload.route,transitionError:null});case d:return E({},t,{transitionRoute:null,transitionError:null,previousRoute:e.payload.previousRoute,route:e.payload.route});case f:return E({},t,{transitionRoute:e.payload.route,transitionError:e.payload.transitionError});case v:return E({},t,{transitionRoute:null,transitionError:null});default:return t}},t.actions=A,t.actionTypes=T,t.routeNodeSelector=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"router",n=function(t){return t[e]||t.get&&t.get(e)},r=void 0;return function(e){var o=n(e),u=o.route,a=o.previousRoute,i=u?s(u,a).intersection:"";return r?(!a||a!==u&&i===t)&&(r={route:u,previousRoute:a}):r={route:u,previousRoute:a},r}},t.reduxPlugin=o,Object.defineProperty(t,"__esModule",{value:!0})});
